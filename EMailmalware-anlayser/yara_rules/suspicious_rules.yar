rule Suspicious_Script_Patterns {
    meta:
        description = "Detects common suspicious scripts used in malware attachments"
    strings:
        $s1 = "eval(base64_decode" ascii wide
        $s2 = "powershell.exe -ExecutionPolicy Bypass" ascii wide
        $s3 = "WScript.Shell" ascii wide
        $s4 = "CreateObject(\"Adodb.Stream\")" ascii wide
        $s5 = "cmd.exe /c" ascii wide
        $s6 = "Shell.Application" ascii wide
    condition:
        any of them
}

rule Generic_EICAR {
    meta:
        description = "Detects EICAR test string"
    strings:
        $eicar = "X5O!P%@AP[4\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*"
    condition:
        $eicar
}
